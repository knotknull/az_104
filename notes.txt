AZ-104 Microsoft Azure Administrator Certification Prep
https://learn.acloud.guru/course/160303d7-6947-4fbc-9d19-fa304849f92e/dashboard:


https://learn.microsoft.com/en-us/credentials/certifications/azure-administrator/?practice-assessment-type=certification

Test: 
- 40 to 60 questions in 120 minutes
- 700 passing score / 70%

# Additional Material: Azure Storage Deep Dive
https://learn.acloud.guru/course/17ee4dc4-6f8e-4411-b0e9-26bdd4b8936c/dashboard




##################################################################
## Azure Admin
##################################################################

# Resource manager 

Resources: entity managed by Azure 
    - VM, Storage Accoutns, Virtual Networks
    - grouped into Resource Groups

Resource Group:
    - logical container for grouping resoruces
    - group by lifecycle / security
    - Associated with Subscription

Azure Subscription:
    - logical construct that groups resource groups and associated resources
    - billing unit
    - interacts with Azure Resource Manager

Azure Resource Manager:
    - orchestration layer ofr managing Azure Cloud
    - uses REST API endpoints (Portal, CLI, PowerShell)
    NOTE: ARM interacts with Azure Resource Providers



    Portal          CLI        PowerShell
      +--------------+--------------+   
                     |
    Azure Resource Manager (ARM)
                     |
        Azure Resource Provider
                     |
    +---------------------------------------+
    | Subscription                          |
    |                                       |
    |     +-----------------------------+   |
    |     | Resource Group              |   |
    |     |                             |   |
    |     |  +----------+  +----------+ |   |
    |     |  | Resource |  | Resource | |   |
    |     |  |   VM     |  |  Disk    | |   |
    |     |  +----------+  +----------+ |   |
    |     |                             |   |
    |     +-----------------------------+   |
    |                                       |
    +---------------------------------------+

Tips: 
    - resources are Azure managed entities (VM, networks, storage, etc)
    - resources are contained in resource groups
    - resources groups contained within Subscription
    - REST API endpoints to manage resources thru Azure Resource Manager 
    - Azure Resource Manager  is a management service
    - each resource has a resource provider 

# Azure Portal and Cloud Shell
Azure Portal:
    - web based portal for Azure cloud
    - create / manage resoruces
    - uses cloud shell


# Azure CLI and PowerShell
- Command Line utility for managing Azure resources
  - create and maange


PS: Get-CloudDrive:

FileShareName      : mapaccfileshr
FileSharePath      : //mapaccstorage.file.core.windows.net/mapaccfileshr
MountPoint         : /home/marc/clouddrive
Name               : mapaccstorage
ResourceGroupName  : LabResources
StorageAccountName : mapaccstorage
SubscriptionId     : cd002162-3eff-42ee-9220-................


Bash:
az group list



# Using ARM Templates

ARM Template (see ./scripts/azuredeploy.json)

ARM Template: 
  - Azure Resoruce Manager Templates
  - Infrastructure as Code
  - repeatable / quick deployment


Components of an ARM Template: 
{
    "$schema": "https://schema.management.azure.com",
    "contentVersion": "1.0.0.0",
    "parameters": {},
    "variables": {},
    "resources": {},
    "outputs": {},
}

parameters / variables: used to pass info to template
resources:  defines resources to create via template
outputs  :  return output from execution of template ( i.e. IP Address)

located in Home > Template specs

NOTE: Templates will be retired on March 31, 2025. 
      To store and share ARM templates, use the new template specs. Learn more about ARM template specs 


##################################################################
## Governance and Compliance
##################################################################

# Managing Subscriptions
Subscription 
 - billing unit of resources 
 - contain resource grups and associated resource groups
 - scope level for governance and security
     i.e. deploy form templates
 - can be associated with azure AD tenent

Types of Subscriptions
 - Pay-as-you-go
 - Pay-As-You-Go
 - Azure for Students
 - Professional Direct Support
 - Standard Support
 - Developer Support
 - Vistual Studio Professional Subscription
 - Vistual Studio Enterprise Subscription
etc


Subscription Naming Conventions
 - Prod / Dev / Staging
 - Dept / Team  (i.e. marketing / engineering)
 - Region (US / LATAM / EMEA)


# Using Management Groups

- organize / manage subscriptions by logically grouping them into management groups 
- orginizational hierarchy
- scope for enforcing governance / compliance 
- RBAC

            [Management Group: Root]
                  |
     +------------+------------+
  [sub a]       [sub b]     [mgmt grp: X]


Parent - Child relationships:   **
 - Root management group is top-level
 - mgmt grp and subs have single parent
 - 6 levels of hierarchy    **

Compliance Suppport
 - Azure Policies
 - Azure role-based access control (RBAC)

NOTE: RBAC roles flow down hierarchy

Root Management group cannot be moved or deleted
RBAC supported for management groups

NOTE: Global admins must be elevated to User Access Admin of root group

# Azure Policy
Policy 
  - enforce compliance / enable auditing
  - prohibit resources 
     - restrict acciss
  - allowed locations
     - geo compliance

2 components of Azure Policy:
    - Policy Definition
        - defines evaluation criteria for compliance
        - defines actions that take place
            - audit / denay outside of compliance

    - Policy Assignment
        - scope at where policy will be assigned: management group, subscription, resource group, resource 


When resources are out of scope with policy: 
    - creation can be denied 
    - or audited


Initiative Definition:    **
  - collection of policies that are tailored to achieving a 
    singular high-level goal (i.e. VM standards: location, sizing, etc.) 

ex. policy definition: 
    - VM must be created with project tag, if missing creation fails
    - assign policy at the scope of resource i.e. resource group

# Tagging resources

tag: name / value pair
 i.e.   dept:Marketing
        env:Prod

name : 512 chars   **
value: 256 chars
storage accounts: 128 chars
50 tags to a resource ** 

 - Tags are NOT inherited


LAB: 
# list resource groups
az group list

# update resorce group tags
az group update --resource-group "<RESOURCE_GROUP_NAME>" --tags "Environment=Production" "Dept=IT" "CreatedBy=<YourName>"


# list VMs, remove and set tags
az vm list --query '[].{name:name, resourceGroup:resourceGroup, tags:tags}' -o json
az vm update -g "<RESOURCE_GROUP_NAME>" -n webvm1 --remove tags.defaultExperience
az vm update -g "<RESOURCE_GROUP_NAME>" -n webvm1 --set tags.MarkForDeletion=Yes

# list virtual networks, overwrite tags
az network vnet list --query '[].{name:name, resourceGroup:resourceGroup, tags:tags}' -o json
az resource tag --tags "Dept=IT" "Environment=Production" "CreatedBy=<YourName>" --resource-group "<RESOURCE_GROUP_NAME>" -n "vnet1" --resource-type "Microsoft.Network/virtualNetworks"


# Locking / Moving Resources

Locks
 - override permissions to resources 
    - subscriptions, resource groups, resources
 - apply to all users and roles

Types: 
  ReadOnly Lock 
    - no delete or update, can read if authorized
  CanNotDelete
    - no delete, can read or modify if authorized

NOTE: Locks interited from parent scope 
    i.e. from subscription down

Moving Resources:
  - from resource grp to resource grp
  - from subcription to subscription
  - in Resource Group Overview > Move
NOTE: Moving resources between resouce groups is an "update" operation


# Managing Azure Costs

 - Subscription Type: 
    - Enterprise Agreement
    - Cloud Solution Provider
    - Pay as you go

 - Resource Type:
    - storage account: Blob vs. Table
 
 - Usage Meters:
    - CPU, ingress/egress, disk size

 - Resource Usage:
    - Cost of using a resource

 - Location
    - services have varying costs across geographical regions 

Best Practice:
 - right size for the use case
 - deallocate when not needed
 - use cloud capabilities when possible:  scalability, elasticity
 - plan costs

Tools:
 - pricing calculator  "Azure Pricing Calculator"
 - TCO Calculator
 - Cost Management Calculator


# Building a Cloud Governance Strategy

Governance: 
    - Rules
    - Policies
    - Standards

Control:
    - enforce rules
    - enforce policies and standards
  
- Define:  governance of organization
- Plan:    which tools to implement governance 
- Ready:   understand how tools will be used to implement governance
- Adopt:   implement governance for organization using cloud strategy

Governance:
 - Management Groups 
 - Subscriptions 
 - Azure RBAC
 - Policies
 - Locks / Tagging


                Policy 
                   |
Management Groups -> Subscription -> Resource Groups
                                         |
                                       RBAC


Blueprints: Policies, Subscriptions, RBAC, Resouce Groups packaged together


##################################################################
## Identity
##################################################################

Identity and Access Management Basics 

Principal:  unauthenticated entity that will seek to authenticate as an Identity
Identity :  Identity profile that is authenticated using credentials
Authorizations :  actions that are premitted / prohibited for an identity to perform


# Azure Active Directory (Azure AD)
    - Identity and Access Management  (IAM)
        - global cloud-based identity service for Azure that provides an identity repo
        - users / groups
        - Manage Identity Security: MFA, resource access, policy-based controls


Azure AD is global 
    - Azure AD Tenant will be based in a region (i.e. US vs EU) 


Tenant: is an instance of Azure AD
    default domain name for tenant:  xyz.onmicrosoft.com
    can be associated with multiple subscriptions


Organization == Tenant == Directory

Collaboration:
    Azure AD B2B / B2C allows access across tenants

Monitoring:
    audit logs, security monitoirng, risk management

Identity Integration:
 - Hybrid / SSO using Azure AD Connect and Azure AD Domain Services

Enterprise Access:
 - Additiona security for apps and devices 
    - on prem and in cloud


Active  Dirctory                vs.             Azure AD
- Organizationa Units (OUs)             - Administrative units
- Group Policy Objects (GPOs)           - SAML, WS-Federation, OAuth
- Kerberos, LDAP, NTLM                  - Flat directory structure
- Hierarchical                          - cloud-based solution
- On-Premises                           - Global


AD Connect can interact between both

# Managing Tenants

Designing Tenants:

        [- Monitor/Automate -]          : Monitor admin, perform access reviews, automate user lifecycles
      [----- Manage Apps  -----]        : Identify apps to be used and register on-prem 
  [----- Populate ID Resources -----]   : Add users, create groups, add devices setup hybird identities
[-----  Build Secure Foundations -----] : MFA, Backup global admin, Self Service Password Reset, privileged users



Azure Active Directory: Global 
 - specific instance of Az AD is a tenant
    - in geographical region (US)
    - users, groups, devices, etc



# Creating / Managing Users


NOTE:  Microsoft Entra ID is new name for Azure AD,  AAD -->> ME-ID

 - Members have default perms
 - identities are JSON objects
 - each user can have role assignments
 - each user can have object ownership

Types of Users:
    - Admins: administrator role assigned
    - regular users: native to Azure AD (Entra Id)
    - guests: external uers invited to tenant

Methods to create users:
    Portal: Default Directory>  Users  > Create User
    AZ cli:  az ad user create
    PowerShell:  New-AzureADUser

    Portal: Default Directory>  Users  > Bulk Operations:
        - Bulk create
        - Bulk invite
        - Bulk delete


Entra ID (ME-ID) -> User -> Role Assignment
                     +----> Object Ownership


# Creating / Managing Groups

 - manager role assignments / subscriptions, etc for similar users i.e. HR
 - create a group and assign subscriptions / role assignments to the group 


Type of Group : 
  - security group
        - used to manage access to shared resources for a group of users

  - Microsoft 365 Group
        - used to give members access to shared mailbox, calendar, files, etc

Membership Type:
  - assigned  
  - dynamic users
    - assign by property of a user 
        if property changes they are no longer part of that group 
          i.e. if dept=HR becomes dept=Billing 
          or usertype = Guest
  - dynamic device






## Role-Based Access Control
## Azure Storage
## Virutal Networking 
## Intersite Connectivity
## Azure Virtual Machines
## Network Traffic Management
## Web Apps and Containers
## Monitoring
## Backup and recovery


.